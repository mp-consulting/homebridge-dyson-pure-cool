{
  "pluginAlias": "DysonPureCool",
  "pluginType": "platform",
  "singular": true,
  "headerDisplay": "Homebridge plugin for Dyson Pure Cool, Hot+Cool, Humidify+Cool, and Big+Quiet devices. The most feature-rich Dyson plugin for HomeKit.",
  "footerDisplay": "For help, see the [README](https://github.com/homebridge/homebridge-dyson-pure-cool#readme)",
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Platform Name",
        "type": "string",
        "default": "Dyson Pure Cool",
        "description": "The name that will appear in Homebridge logs"
      },
      "email": {
        "title": "Dyson Account Email",
        "type": "string",
        "format": "email",
        "description": "Your Dyson account email (optional if using manual device configuration)"
      },
      "password": {
        "title": "Dyson Account Password",
        "type": "string",
        "description": "Your Dyson account password"
      },
      "countryCode": {
        "title": "Country Code",
        "type": "string",
        "default": "US",
        "description": "Your Dyson account country code (e.g., US, GB, DE, FR)"
      },
      "discoveryTimeout": {
        "title": "Discovery Timeout",
        "type": "integer",
        "default": 30,
        "minimum": 5,
        "maximum": 120,
        "description": "Timeout in seconds for mDNS device discovery on local network"
      },
      "pollInterval": {
        "title": "Poll Interval",
        "type": "integer",
        "default": 60,
        "minimum": 10,
        "maximum": 300,
        "description": "Interval in seconds to poll device state"
      },
      "devices": {
        "title": "Manual Device Configuration",
        "type": "array",
        "description": "Manually configure devices instead of using Dyson Cloud (optional)",
        "items": {
          "type": "object",
          "properties": {
            "name": {
              "title": "Device Name",
              "type": "string",
              "description": "Display name for this device"
            },
            "serial": {
              "title": "Serial Number",
              "type": "string",
              "description": "Device serial number (format: ABC-AB-12345678)"
            },
            "productType": {
              "title": "Product Type",
              "type": "string",
              "oneOf": [
                { "title": "TP02 - Pure Cool Link Tower", "enum": ["475"] },
                { "title": "TP04 - Pure Cool Tower", "enum": ["438"] },
                { "title": "TP06 - Pure Cool Tower", "enum": ["358"] },
                { "title": "TP07 - Purifier Cool", "enum": ["438E"] },
                { "title": "TP09 - Pure Cool Formaldehyde", "enum": ["438K"] },
                { "title": "DP01 - Pure Cool Link Desk", "enum": ["469"] },
                { "title": "DP04 - Pure Cool Desk", "enum": ["520"] },
                { "title": "HP02 - Pure Hot+Cool Link", "enum": ["455"] },
                { "title": "HP04 - Pure Hot+Cool", "enum": ["527"] },
                { "title": "HP06 - Pure Hot+Cool", "enum": ["358K"] },
                { "title": "HP07 - Pure Hot+Cool", "enum": ["527E"] },
                { "title": "HP09 - Pure Hot+Cool Formaldehyde", "enum": ["527K"] },
                { "title": "PH01 - Purifier Humidify+Cool", "enum": ["358J"] },
                { "title": "PH02 - Purifier Humidify+Cool", "enum": ["520E"] },
                { "title": "PH03 - Purifier Humidify+Cool", "enum": ["358H"] },
                { "title": "PH04 - Purifier Humidify+Cool Formaldehyde", "enum": ["520F"] },
                { "title": "BP02 - Purifier Big+Quiet", "enum": ["664"] },
                { "title": "BP03 - Purifier Big+Quiet Formaldehyde", "enum": ["664B"] },
                { "title": "BP04 - Purifier Big+Quiet Formaldehyde", "enum": ["664E"] },
                { "title": "BP06 - Purifier Big+Quiet", "enum": ["664F"] }
              ],
              "description": "Select your Dyson device model"
            },
            "credentials": {
              "title": "Local Credentials",
              "type": "string",
              "description": "Device local MQTT password (from Dyson Cloud API)"
            },
            "ipAddress": {
              "title": "IP Address",
              "type": "string",
              "format": "ipv4",
              "description": "Device IP address on local network"
            },
            "temperatureOffset": {
              "title": "Temperature Offset",
              "type": "number",
              "default": 0,
              "minimum": -10,
              "maximum": 10,
              "description": "Adjust temperature reading by this amount in Celsius"
            },
            "humidityOffset": {
              "title": "Humidity Offset",
              "type": "integer",
              "default": 0,
              "minimum": -20,
              "maximum": 20,
              "description": "Adjust humidity reading by this percentage"
            },
            "fullRangeHumidity": {
              "title": "Full Range Humidity",
              "type": "boolean",
              "default": false,
              "description": "Enable 0-100% humidity range for humidifier (default: 30-70%)"
            },
            "enableAutoModeWhenActivating": {
              "title": "Enable Auto Mode on Activation",
              "type": "boolean",
              "default": false,
              "description": "Automatically enable auto mode when turning device on"
            },
            "enableOscillationWhenActivating": {
              "title": "Enable Oscillation on Activation",
              "type": "boolean",
              "default": false,
              "description": "Automatically enable oscillation when turning device on"
            },
            "enableNightModeWhenActivating": {
              "title": "Enable Night Mode on Activation",
              "type": "boolean",
              "default": false,
              "description": "Automatically enable night mode when turning device on"
            }
          },
          "required": ["serial", "productType", "credentials", "ipAddress"]
        }
      },
      "enableTemperature": {
        "title": "Enable Temperature Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show temperature sensor in HomeKit"
      },
      "enableHumidity": {
        "title": "Enable Humidity Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show humidity sensor in HomeKit"
      },
      "enableAirQuality": {
        "title": "Enable Air Quality Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show air quality sensor (PM2.5, PM10, VOC, NO2) in HomeKit"
      },
      "enableNightMode": {
        "title": "Enable Night Mode Switch",
        "type": "boolean",
        "default": true,
        "description": "Show night mode toggle switch in HomeKit"
      },
      "enableContinuousMonitoring": {
        "title": "Enable Continuous Monitoring Switch",
        "type": "boolean",
        "default": false,
        "description": "Show continuous monitoring toggle switch in HomeKit"
      },
      "enableJetFocus": {
        "title": "Enable Jet Focus Switch",
        "type": "boolean",
        "default": true,
        "description": "Show jet focus (front airflow) toggle switch in HomeKit"
      },
      "enableHeater": {
        "title": "Enable Heater (HP Models)",
        "type": "boolean",
        "default": true,
        "description": "Show thermostat control for Hot+Cool models"
      },
      "enableHumidifier": {
        "title": "Enable Humidifier (PH Models)",
        "type": "boolean",
        "default": true,
        "description": "Show humidifier control for Humidify+Cool models"
      },
      "enableFilter": {
        "title": "Enable Filter Status",
        "type": "boolean",
        "default": true,
        "description": "Show filter life remaining in HomeKit"
      }
    },
    "required": ["name"]
  },
  "layout": [
    {
      "type": "fieldset",
      "title": "Dyson Account",
      "description": "Enter your Dyson account credentials for automatic device discovery",
      "items": [
        "email",
        "password",
        "countryCode"
      ]
    },
    {
      "type": "fieldset",
      "title": "Discovery Settings",
      "expandable": true,
      "items": [
        "discoveryTimeout",
        "pollInterval"
      ]
    },
    {
      "type": "fieldset",
      "title": "HomeKit Features",
      "description": "Choose which features to expose in HomeKit",
      "expandable": true,
      "items": [
        "enableTemperature",
        "enableHumidity",
        "enableAirQuality",
        "enableNightMode",
        "enableContinuousMonitoring",
        "enableJetFocus",
        "enableHeater",
        "enableHumidifier",
        "enableFilter"
      ]
    },
    {
      "type": "fieldset",
      "title": "Manual Device Configuration",
      "description": "Configure devices manually without Dyson Cloud. Use this if automatic discovery fails or if you have network restrictions.",
      "expandable": true,
      "items": [
        {
          "key": "devices",
          "type": "array",
          "buttonText": "Add Device",
          "items": [
            "devices[].name",
            "devices[].serial",
            "devices[].productType",
            "devices[].credentials",
            "devices[].ipAddress",
            {
              "type": "fieldset",
              "title": "Sensor Calibration",
              "expandable": true,
              "items": [
                "devices[].temperatureOffset",
                "devices[].humidityOffset"
              ]
            },
            {
              "type": "fieldset",
              "title": "Activation Behaviors",
              "expandable": true,
              "items": [
                "devices[].enableAutoModeWhenActivating",
                "devices[].enableOscillationWhenActivating",
                "devices[].enableNightModeWhenActivating",
                "devices[].fullRangeHumidity"
              ]
            }
          ]
        }
      ]
    }
  ]
}
