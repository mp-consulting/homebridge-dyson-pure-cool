{
  "pluginAlias": "DysonPureCool",
  "pluginType": "platform",
  "singular": true,
  "customUi": true,
  "schema": {
    "type": "object",
    "properties": {
      "name": {
        "title": "Name",
        "type": "string",
        "default": "Dyson Pure Cool",
        "description": "Plugin name as it appears in Homebridge logs"
      },
      "countryCode": {
        "title": "Country Code",
        "type": "string",
        "default": "US",
        "description": "Your Dyson account country code",
        "oneOf": [
          { "title": "United States", "enum": ["US"] },
          { "title": "United Kingdom", "enum": ["GB"] },
          { "title": "Germany", "enum": ["DE"] },
          { "title": "France", "enum": ["FR"] },
          { "title": "Italy", "enum": ["IT"] },
          { "title": "Spain", "enum": ["ES"] },
          { "title": "Netherlands", "enum": ["NL"] },
          { "title": "Belgium", "enum": ["BE"] },
          { "title": "Austria", "enum": ["AT"] },
          { "title": "Switzerland", "enum": ["CH"] },
          { "title": "Australia", "enum": ["AU"] },
          { "title": "New Zealand", "enum": ["NZ"] },
          { "title": "Canada", "enum": ["CA"] },
          { "title": "Ireland", "enum": ["IE"] },
          { "title": "Sweden", "enum": ["SE"] },
          { "title": "Norway", "enum": ["NO"] },
          { "title": "Denmark", "enum": ["DK"] },
          { "title": "Finland", "enum": ["FI"] },
          { "title": "Japan", "enum": ["JP"] },
          { "title": "Singapore", "enum": ["SG"] },
          { "title": "Hong Kong", "enum": ["HK"] },
          { "title": "China", "enum": ["CN"] }
        ]
      },
      "devices": {
        "title": "Devices",
        "type": "array",
        "description": "List of Dyson devices to control",
        "items": {
          "type": "object",
          "properties": {
            "serial": {
              "title": "Serial Number",
              "type": "string",
              "description": "Device serial number (e.g., ABC-US-12345678)",
              "pattern": "^[A-Z0-9]{3}-[A-Z]{2}-[A-Z0-9]+$"
            },
            "name": {
              "title": "Device Name",
              "type": "string",
              "description": "Display name for this device"
            },
            "productType": {
              "title": "Product Type",
              "type": "string",
              "description": "Dyson product type code",
              "oneOf": [
                { "title": "Pure Cool Tower (TP04)", "enum": ["438"] },
                { "title": "Pure Cool Tower (TP07)", "enum": ["438E"] },
                { "title": "Pure Cool Tower Formaldehyde (TP09)", "enum": ["438K"] },
                { "title": "Pure Cool Desk (DP04)", "enum": ["520"] },
                { "title": "Pure Hot+Cool (HP04)", "enum": ["527"] },
                { "title": "Pure Hot+Cool (HP07)", "enum": ["527E"] },
                { "title": "Pure Hot+Cool Formaldehyde (HP09)", "enum": ["527K"] },
                { "title": "Pure Hot+Cool Link (HP02)", "enum": ["455"] },
                { "title": "Pure Cool Link Desk (DP01)", "enum": ["469"] },
                { "title": "Pure Cool Link Tower (TP02)", "enum": ["475"] },
                { "title": "Purifier Big+Quiet (BP03)", "enum": ["664"] },
                { "title": "Purifier Big+Quiet (BP04)", "enum": ["664E"] }
              ]
            },
            "localCredentials": {
              "title": "Local Credentials",
              "type": "string",
              "description": "MQTT password for local device connection (obtained from Dyson cloud)"
            },
            "ipAddress": {
              "title": "IP Address (Optional)",
              "type": "string",
              "description": "Static IP address (leave empty for auto-discovery)",
              "format": "ipv4"
            }
          },
          "required": ["serial", "productType", "localCredentials"]
        }
      },
      "enableTemperature": {
        "title": "Enable Temperature Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show temperature readings in HomeKit"
      },
      "enableHumidity": {
        "title": "Enable Humidity Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show humidity readings in HomeKit"
      },
      "enableAirQuality": {
        "title": "Enable Air Quality Sensor",
        "type": "boolean",
        "default": true,
        "description": "Show air quality index in HomeKit"
      },
      "enableNightMode": {
        "title": "Enable Night Mode Switch",
        "type": "boolean",
        "default": true,
        "description": "Add a switch to control night mode"
      },
      "enableAutoMode": {
        "title": "Enable Auto Mode Switch",
        "type": "boolean",
        "default": true,
        "description": "Add a switch to control auto mode"
      },
      "enableFilterStatus": {
        "title": "Enable Filter Status",
        "type": "boolean",
        "default": false,
        "description": "Show filter life remaining indicator"
      },
      "pollingInterval": {
        "title": "Polling Interval",
        "type": "integer",
        "default": 60,
        "minimum": 10,
        "maximum": 300,
        "description": "How often to check device status (in seconds)"
      }
    },
    "required": ["name"]
  },
  "layout": [
    {
      "type": "fieldset",
      "title": "Devices",
      "description": "Use the custom UI wizard above to configure devices automatically, or add them manually below.",
      "expandable": true,
      "expanded": false,
      "items": [
        {
          "key": "devices",
          "type": "array",
          "items": [
            "devices[].serial",
            "devices[].name",
            "devices[].productType",
            "devices[].localCredentials",
            "devices[].ipAddress"
          ]
        }
      ]
    },
    {
      "type": "fieldset",
      "title": "Sensor Options",
      "expandable": true,
      "expanded": false,
      "items": [
        "enableTemperature",
        "enableHumidity",
        "enableAirQuality"
      ]
    },
    {
      "type": "fieldset",
      "title": "Additional Controls",
      "expandable": true,
      "expanded": false,
      "items": [
        "enableNightMode",
        "enableAutoMode",
        "enableFilterStatus"
      ]
    },
    {
      "type": "fieldset",
      "title": "Advanced Settings",
      "expandable": true,
      "expanded": false,
      "items": [
        "countryCode",
        "pollingInterval"
      ]
    }
  ]
}
